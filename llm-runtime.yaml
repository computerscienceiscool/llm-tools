# LLM Tool Configuration with Search Support
# This file configures the behavior of the LLM file access tool including the new search functionality

repository:
  # Root directory of the repository to explore
  root: "."
  
  # Paths and patterns to exclude from access and indexing
  excluded_paths:
    - ".git"
    - ".env"
    - ".env.local"
    - "*.key"
    - "*.pem"
    - "*.p12"
    - "*.pfx"
    - "node_modules"
    - "__pycache__"
    - ".DS_Store"
    - "*.sqlite"
    - "*.db"
    - "secrets"
    - "credentials"
    - "vendor"
    - "search-env"

commands:
  # Open command configuration
  open:
    enabled: true
    max_file_size: 1048576  # 1MB
    require_confirmation: false
    backup_before_write: true
    allowed_extensions:
      - ".go"
      - ".py"
      - ".js"
      - ".md"
      - ".txt"
      - ".json"
      - ".yaml"
      - ".yml"
      - ".toml"
    format_code: true
    atomic_writes: true
    
  # Write command configuration
  write:
    enabled: true
    max_file_size: 102400  # 100KB
    require_confirmation: false
    backup_before_write: true
    
  # Exec command configuration
  exec:
    enabled: true
    container_image: "python-go"
    timeout_seconds: 30
    memory_limit: "512m"
    cpu_limit: 1
    network_enabled: false
    whitelist:
      - "go test"
      - "go build" 
      - "go run"
      - "go version"
      - "npm test"
      - "npm run build"
      - "python -m pytest"
      - "python3 -m pytest"
      - "python3"
      - "python"
      - "make"
      - "make test"
      - "make build"
      - "cargo build"
      - "cargo test"
      - "cargo run"
      - "node"
      - "npm install"
      - "pip install"
      - "pip3 install"
      - "ls"
      - "cat"
      - "grep"
      - "find"
      - "head"
      - "tail"
      - "wc"
    
  # Search command configuration
  search:
    # Enable/disable semantic search functionality
    enabled: true
    
    # Database path for storing embeddings
    vector_db_path: "./embeddings.db"
    
    # Embedding model to use (sentence-transformers model)
    embedding_model: "all-MiniLM-L6-v2"
    
    # Maximum number of search results to return
    max_results: 10
    
    # Minimum similarity score (0.0 to 1.0) to include in results
    min_similarity_score: 0.3
    
    # Maximum length of preview text for each result
    max_preview_length: 100
    
    # Chunk size for processing large files (in tokens)
    chunk_size: 1000
    
    # Python interpreter path
    python_path: "python3"
    
    # File extensions to index for search
    index_extensions:
      - ".go"
      - ".py"
      - ".js"
      - ".ts"
      - ".jsx"
      - ".tsx"
      - ".md"
      - ".txt"
      - ".yaml"
      - ".yml"
      - ".json"
      - ".toml"
      - ".rs"
      - ".java"
      - ".c"
      - ".cpp"
      - ".h"
      - ".hpp"
      - ".sh"
      - ".bash"
      - ".zsh"
      - ".fish"
      - ".sql"
      - ".html"
      - ".css"
      - ".scss"
      - ".less"
      - ".xml"
      - ".proto"
      - ".dockerfile"
      - ".makefile"
    
    # Maximum file size to index (in bytes)
    max_file_size: 1048576  # 1MB

security:
  # Maximum operations per minute
  rate_limit_per_minute: 100
  
  # Enable audit logging
  log_all_operations: true
  audit_log_path: "./audit.log"
  
  # Additional security settings
  follow_symlinks: true
  allow_hidden_files: false
  
output:
  # Output format settings
  show_summaries: true
  show_execution_time: true
  truncate_large_outputs: true
  max_output_lines: 1000
  
logging:
  # Logging configuration
  level: "info"  # debug, info, warn, error
  file: "./llm-runtime.log"
  format: "json"  # json or text

# Search Setup Instructions:
#
# 1. Install Python dependencies:
#    pip install sentence-transformers
#
# 2. Enable search by setting search.enabled: true above
#
# 3. Build initial search index:
#    ./llm-runtime --reindex
#
# 4. Test search functionality:
#    echo "Find authentication code <search auth>" | ./llm-runtime
#
# Search Command Examples for LLMs:
# - <search authentication logic>
# - <search database connection>  
# - <search error handling>
# - <search test cases>
# - <search API endpoints>
# - <search configuration>
# - <search utility functions>
#
# Command Line Search Management:
# - ./llm-runtime --reindex              # Full reindex
# - ./llm-runtime --search-status        # Show index stats
# - ./llm-runtime --search-validate      # Validate index
# - ./llm-runtime --search-cleanup       # Clean deleted files
# - ./llm-runtime --check-python-setup   # Verify dependencies
